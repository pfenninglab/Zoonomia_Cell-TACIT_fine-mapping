Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.05.
In training mode.
Model exists w/o permission to overwrite. Use --force to overwrite.
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.05.
In evaluation mode.
There 48948 positives and 35420 negatives.
2637/2637 - 21s
Accuracy: 0.5. 
f1_score: 0.24827674412671064.
roc_auc: 0.5.
prc_auc: 0.7900862886402428.
Model performance written to /projects/pfenninggroup/machineLearningForComputationalBiology/snATAC_cross_species_caudate/data/raw_data/cnn_enhancer_ortholog/predictions/MSN_D1_hgRmMm_enhVsNonEnhOrth/MSN_D1_hgRmMm_enhVsNonEnhOrth_OCP_NB1000_NE23_BR0.1_MR1.0_BM0.85_MM0.99_DO0.05_testPerformance.feather
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.1.
In training mode.
Model exists w/o permission to overwrite. Use --force to overwrite.
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.1.
In evaluation mode.
There 48948 positives and 35420 negatives.
2637/2637 - 21s
Traceback (most recent call last):
  File "train_singleTask_CNN_classifier_OCP.py", line 295, in <module>
    main(args)
  File "train_singleTask_CNN_classifier_OCP.py", line 217, in main
    df = evaluate_sequences(model_name, x_valid, y_valid, ids_valid, args)
  File "train_singleTask_CNN_classifier_OCP.py", line 125, in evaluate_sequences
    roc_auc = metrics.roc_auc_score(tmp['y'], tmp['y_pred_score'])
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 73, in inner_f
    return f(**kwargs)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/metrics/_ranking.py", line 372, in roc_auc_score
    y_score = check_array(y_score, ensure_2d=False)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 73, in inner_f
    return f(**kwargs)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 646, in check_array
    allow_nan=force_all_finite == 'allow-nan')
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 100, in _assert_all_finite
    msg_dtype if msg_dtype is not None else X.dtype)
ValueError: Input contains NaN, infinity or a value too large for dtype('float32').
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.15.
In training mode.
Model exists w/o permission to overwrite. Use --force to overwrite.
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.15.
In evaluation mode.
There 48948 positives and 35420 negatives.
2637/2637 - 21s
Traceback (most recent call last):
  File "train_singleTask_CNN_classifier_OCP.py", line 295, in <module>
    main(args)
  File "train_singleTask_CNN_classifier_OCP.py", line 217, in main
    df = evaluate_sequences(model_name, x_valid, y_valid, ids_valid, args)
  File "train_singleTask_CNN_classifier_OCP.py", line 125, in evaluate_sequences
    roc_auc = metrics.roc_auc_score(tmp['y'], tmp['y_pred_score'])
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 73, in inner_f
    return f(**kwargs)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/metrics/_ranking.py", line 372, in roc_auc_score
    y_score = check_array(y_score, ensure_2d=False)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 73, in inner_f
    return f(**kwargs)
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 646, in check_array
    allow_nan=force_all_finite == 'allow-nan')
  File "/home/bnphan/miniconda3/envs/tf2/lib/python3.6/site-packages/sklearn/utils/validation.py", line 100, in _assert_all_finite
    msg_dtype if msg_dtype is not None else X.dtype)
ValueError: Input contains NaN, infinity or a value too large for dtype('float32').
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.2.
In training mode.
Model exists w/o permission to overwrite. Use --force to overwrite.
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.2.
In evaluation mode.
There 48948 positives and 35420 negatives.
2637/2637 - 21s
Accuracy: 0.5. 
f1_score: 0.24827674412671064.
roc_auc: 0.5.
prc_auc: 0.7900862886402428.
Model performance written to /projects/pfenninggroup/machineLearningForComputationalBiology/snATAC_cross_species_caudate/data/raw_data/cnn_enhancer_ortholog/predictions/MSN_D1_hgRmMm_enhVsNonEnhOrth/MSN_D1_hgRmMm_enhVsNonEnhOrth_OCP_NB1000_NE23_BR0.1_MR1.0_BM0.85_MM0.99_DO0.2_testPerformance.feather
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.25.
In training mode.
There 380766 positives and 283508 negatives.
Traceback (most recent call last):
  File "train_singleTask_CNN_classifier_OCP.py", line 295, in <module>
    main(args)
  File "train_singleTask_CNN_classifier_OCP.py", line 200, in main
    (x_train, y_train, ids_train) = encode_sequence(args.train_fasta_pos, args.train_fasta_neg, size = args.seq_length, shuffleOff = False)
  File "/projects/pfenninggroup/machineLearningForComputationalBiology/snATAC_cross_species_caudate/code/raw_code/cnn_enhancer_ortholog/cnn_utils.py", line 57, in encode_sequence
    ids = ids[indices]
TypeError: only integer scalar arrays can be converted to a scalar index
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.25.
In evaluation mode.
No model found with specified training parameters. Please train model first.
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.3.
In training mode.
There 380766 positives and 202229 negatives.
Traceback (most recent call last):
  File "train_singleTask_CNN_classifier_OCP.py", line 295, in <module>
    main(args)
  File "train_singleTask_CNN_classifier_OCP.py", line 200, in main
    (x_train, y_train, ids_train) = encode_sequence(args.train_fasta_pos, args.train_fasta_neg, size = args.seq_length, shuffleOff = False)
  File "/projects/pfenninggroup/machineLearningForComputationalBiology/snATAC_cross_species_caudate/code/raw_code/cnn_enhancer_ortholog/cnn_utils.py", line 57, in encode_sequence
    ids = ids[indices]
TypeError: only integer scalar arrays can be converted to a scalar index
Running cyclical learning rate for MSN_D1_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.3.
In evaluation mode.
No model found with specified training parameters. Please train model first.
