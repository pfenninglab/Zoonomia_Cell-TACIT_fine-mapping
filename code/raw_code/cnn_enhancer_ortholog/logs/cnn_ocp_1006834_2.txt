2021-02-14 15:40:42.718057: F ./tensorflow/core/kernels/random_op_gpu.h:232] Non-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch<Distribution>, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) status: Internal: out of memory
/var/spool/slurmd/job1009742/slurm_script: line 55:  8730 Aborted                 python train_singleTask_CNN_classifier_OCP.py --mode 'train' --out_dir $DATADIR --conv_width 11 --l2_reg $L2_REG --dropout $DROPOUT --batch_size $BATCH_SIZE --epochs $EPOCHS --numCycles $NUM_CYCLES --base_lr $BASE_LR --max_lr $MAX_LR --base_m $BASE_M --max_m $MAX_M --verbose 2 --cyclical_momentum $LABEL $TRAINPOSFILE $TRAINNEGFILE $VALIDPOSFILE $VALIDNEGFILE
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.05.
In evaluation mode.
No model found with specified training parameters. Please train model first.
2021-02-14 15:46:43.529477: F ./tensorflow/core/kernels/random_op_gpu.h:232] Non-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch<Distribution>, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) status: Internal: out of memory
/var/spool/slurmd/job1009742/slurm_script: line 55:  8821 Aborted                 python train_singleTask_CNN_classifier_OCP.py --mode 'train' --out_dir $DATADIR --conv_width 11 --l2_reg $L2_REG --dropout $DROPOUT --batch_size $BATCH_SIZE --epochs $EPOCHS --numCycles $NUM_CYCLES --base_lr $BASE_LR --max_lr $MAX_LR --base_m $BASE_M --max_m $MAX_M --verbose 2 --cyclical_momentum $LABEL $TRAINPOSFILE $TRAINNEGFILE $VALIDPOSFILE $VALIDNEGFILE
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.1.
In evaluation mode.
No model found with specified training parameters. Please train model first.
2021-02-14 15:52:54.357492: F ./tensorflow/core/kernels/random_op_gpu.h:232] Non-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch<Distribution>, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) status: Internal: out of memory
/var/spool/slurmd/job1009742/slurm_script: line 55:  8893 Aborted                 python train_singleTask_CNN_classifier_OCP.py --mode 'train' --out_dir $DATADIR --conv_width 11 --l2_reg $L2_REG --dropout $DROPOUT --batch_size $BATCH_SIZE --epochs $EPOCHS --numCycles $NUM_CYCLES --base_lr $BASE_LR --max_lr $MAX_LR --base_m $BASE_M --max_m $MAX_M --verbose 2 --cyclical_momentum $LABEL $TRAINPOSFILE $TRAINNEGFILE $VALIDPOSFILE $VALIDNEGFILE
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.15.
In evaluation mode.
No model found with specified training parameters. Please train model first.
2021-02-14 15:58:56.801472: F ./tensorflow/core/kernels/random_op_gpu.h:232] Non-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch<Distribution>, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) status: Internal: out of memory
/var/spool/slurmd/job1009742/slurm_script: line 55:  8979 Aborted                 python train_singleTask_CNN_classifier_OCP.py --mode 'train' --out_dir $DATADIR --conv_width 11 --l2_reg $L2_REG --dropout $DROPOUT --batch_size $BATCH_SIZE --epochs $EPOCHS --numCycles $NUM_CYCLES --base_lr $BASE_LR --max_lr $MAX_LR --base_m $BASE_M --max_m $MAX_M --verbose 2 --cyclical_momentum $LABEL $TRAINPOSFILE $TRAINNEGFILE $VALIDPOSFILE $VALIDNEGFILE
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.2.
In evaluation mode.
No model found with specified training parameters. Please train model first.
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.25.
In training mode.
There 396702 positives and 286498 negatives.
There 49808 positives and 35642 negatives.
Epoch 1/23
684/684 - 526s - loss: 0.7033 - accuracy: 0.4987 - macro_f1: 0.3662 - val_loss: 0.7056 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 2/23
684/684 - 523s - loss: 0.7011 - accuracy: 0.4957 - macro_f1: 0.3440 - val_loss: 0.6973 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 3/23
684/684 - 523s - loss: 0.7000 - accuracy: 0.5039 - macro_f1: 0.3815 - val_loss: 0.6982 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 4/23
684/684 - 523s - loss: 0.6988 - accuracy: 0.4935 - macro_f1: 0.3411 - val_loss: 0.7055 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 5/23
684/684 - 524s - loss: 0.6978 - accuracy: 0.4994 - macro_f1: 0.3622 - val_loss: 0.6889 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 6/23
684/684 - 523s - loss: 0.6971 - accuracy: 0.4992 - macro_f1: 0.3679 - val_loss: 0.7002 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 7/23
684/684 - 523s - loss: 0.6965 - accuracy: 0.4948 - macro_f1: 0.3408 - val_loss: 0.6868 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 8/23
684/684 - 523s - loss: 0.6959 - accuracy: 0.4970 - macro_f1: 0.3593 - val_loss: 0.6924 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 9/23
684/684 - 523s - loss: 0.6956 - accuracy: 0.5005 - macro_f1: 0.3733 - val_loss: 0.7042 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 10/23
684/684 - 523s - loss: 0.6953 - accuracy: 0.5039 - macro_f1: 0.3815 - val_loss: 0.7046 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 11/23
684/684 - 523s - loss: 0.6950 - accuracy: 0.5013 - macro_f1: 0.3756 - val_loss: 0.6962 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 12/23
684/684 - 523s - loss: 0.6950 - accuracy: 0.4976 - macro_f1: 0.3575 - val_loss: 0.6939 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 13/23
684/684 - 523s - loss: 0.6946 - accuracy: 0.4996 - macro_f1: 0.3691 - val_loss: 0.6989 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 14/23
684/684 - 523s - loss: 0.6945 - accuracy: 0.5009 - macro_f1: 0.3725 - val_loss: 0.7117 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 15/23
684/684 - 523s - loss: 0.6945 - accuracy: 0.5015 - macro_f1: 0.3757 - val_loss: 0.6928 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 16/23
684/684 - 523s - loss: 0.6941 - accuracy: 0.5007 - macro_f1: 0.3696 - val_loss: 0.6911 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 17/23
684/684 - 523s - loss: 0.6941 - accuracy: 0.4995 - macro_f1: 0.3672 - val_loss: 0.6906 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 18/23
684/684 - 523s - loss: 0.6940 - accuracy: 0.5009 - macro_f1: 0.3746 - val_loss: 0.6888 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 19/23
684/684 - 523s - loss: 0.6940 - accuracy: 0.5011 - macro_f1: 0.3727 - val_loss: 0.6923 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 20/23
684/684 - 523s - loss: 0.6938 - accuracy: 0.5063 - macro_f1: 0.3963 - val_loss: 0.6868 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Epoch 21/23
684/684 - 523s - loss: 0.6938 - accuracy: 0.4943 - macro_f1: 0.3444 - val_loss: 0.6970 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 22/23
684/684 - 524s - loss: 0.6936 - accuracy: 0.5027 - macro_f1: 0.3762 - val_loss: 0.7039 - val_accuracy: 0.4171 - val_macro_f1: 0.0000e+00
Epoch 23/23
684/684 - 523s - loss: 0.6937 - accuracy: 0.4995 - macro_f1: 0.3681 - val_loss: 0.6924 - val_accuracy: 0.5829 - val_macro_f1: 0.7363
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.25.
In evaluation mode.
Traceback (most recent call last):
  File "train_singleTask_CNN_classifier_OCP.py", line 274, in <module>
    main(args)
  File "train_singleTask_CNN_classifier_OCP.py", line 197, in main
    (x_valid, y_valid, ids_valid) = encode_sequence2(args.valid_fasta_pos, args.valid_fasta_neg, size = args.seq_length, shuffleOff = True)
TypeError: encode_sequence2() got an unexpected keyword argument 'size'
2021-02-14 19:33:05.035146: F ./tensorflow/core/kernels/random_op_gpu.h:232] Non-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch<Distribution>, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) status: Internal: out of memory
/var/spool/slurmd/job1009742/slurm_script: line 55: 16521 Aborted                 python train_singleTask_CNN_classifier_OCP.py --mode 'train' --out_dir $DATADIR --conv_width 11 --l2_reg $L2_REG --dropout $DROPOUT --batch_size $BATCH_SIZE --epochs $EPOCHS --numCycles $NUM_CYCLES --base_lr $BASE_LR --max_lr $MAX_LR --base_m $BASE_M --max_m $MAX_M --verbose 2 --cyclical_momentum $LABEL $TRAINPOSFILE $TRAINNEGFILE $VALIDPOSFILE $VALIDNEGFILE
Running cyclical learning rate for MSN_D2_hgRmMm_enhVsNonEnhOrth.
One-cycle policy training for 23 epochs.
Learning rates range: 0.1 - 1.0.
Momentum rates range: 0.85 - 0.99.
Dropout: 0.3.
In evaluation mode.
No model found with specified training parameters. Please train model first.
